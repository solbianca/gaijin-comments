# Установка

Последовательно выполнить комманды:

- git clone git@github.com:solbianca/gaijin-comments.git - скачать репозиторий.
- cd gaijin-comments - перейти в корень приложения.
- make up - создаст и запустит контейнеры.
- make install - скочает зависимости, загрузит данные в базу, выполнит необходимые комманды.

Сайт доступен по адрессу http://localhost:8001/

Для логина можно использоват почту:test_1@example.com, пароль: password. В базе есть десять пользователей с почтой
test_1@example.com...test_10@example.com и паролем password. Можно залогиниться под любым из пользователей. При
инициализации базы будет создано несколько тестовых записей комментариев.

Для входа в терминал контейнера приложения:

- make bash

Для остановки приложения:

- make down

Для подключения к базе можно использховать данные:

- host=localhost
- port=5000
- db=gaijin
- username=root
- password=i57z9*UIuJQ!

# Описание приложения

## В приложении реализованно

О сновная страница. Логика атворизации пользователя. Регистрация тоже есть и если настроить мейлер будет работать.
Древовидные комментарии. CRUD команды над комментариями.

При открытии основной страницы из базы данных достает все комментарии, формирует из них валидное дерево и отрисовывает.
на фронте авторизованный пользователь может добавлять новые комментарии либо удалять и редактировать свои в течении часа
после создания. Все операции проихводятся без перезагрузки страницы.

### Код

- /app/app/Http - контроллеры.
- /app/app/Modules/Comments - логика работы с комментариями.

### Не реализовано

Пользователь не может открыть отдельную ветку комментариев или один комментарий. Из базы вытягивает все комментарии без
ограничений. Нет тестов. Добавить сущность комментария, что бы не работать с моделью за пределами репозитория.

# Проблематика

Нак данными можно выполнять четыри вида операций - создание, чтение, обновление и удаление.

Есть несколько проблем, которые необходимо обработать.

### Чтение

При чтении комментариев может быть очень много - тысячи, десятки тысяч. Доставать все комментарии из базы может быть
очень тяжелой операцией. Нееобходимо реализовать логику получения определенного, предсказуемого, числа комментариев из
базы. Что бы запрос на чтение выполнялся прогнозируемое количество времени.

Если необходимо показывать определенную ветку. Надо иметь возможность найти потокомков конкретного комментария. Для
решения этой проблемы можно сохранять полный путь до каждого комментария в отедльной колонке. И если нужно найти всех
потомков конкретного комментария, можно исккать по вхождению пути в данной колонке.

### Удаление

Удаление комментария может стать большой проблемой. Необходимо решить что делать с потомками. Удалить вместе с
удаляемым? Это плохое решение. Сместить на уровень вверх? Это может потребовать пересчета значений колонок всех
потомков. Например, если мы использовали отдельную колонку с путем до комментария. Наиболее рациональный путь это
пометить комментарий флагом “удален” и не показывать его пользователю. Таким образом нам нет необходимости делать
дополнительную и ресурсоемкую работу.

### Обновление

Тут все просто - обновляем текст комментария. Сайдэффекта на другие комментарии нет.

### Создание

Добавление нового комментария тоже может иметь проблемы.

Например, наши комментарии могли бы иметь отдельную колонку, в которой прихранивался поядок вывода комментариев.
Значение нового комментария будет равно инкременту значения последнего существующего. При одновременном добавлении
комментариев разными пользователями может случится ситуация, когда разные комментарии будут иметь одинаковый порядок. В
данном случае необходимо реализовать эксклюзивность доступа к последней существующей записи при создании.

Если есть колонка с полным путем до комментария, то необходимо будет проставить валиидный путь. Это может потребовать
дополнительные запросы на чтение и запись.

### Кеширование

Отдельный вопрос - как комментарии эффективно кешировать. Решать нужно из потребностей конкретного приложения.
